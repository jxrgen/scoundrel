<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scoundrel - Dungeon Crawler</title>
    <style>
        :root {
            --bg-dark: #121215;
            --stone-dark: #1a1a20;
            --stone-light: #252530;
            --text-color: #dcdcd0;
            --card-width: 110px;
            --card-height: 154px;
            --accent-color: #ffcc00;
            --danger-color: #ff4444;
            --heal-color: #66ff66;
            --card-bg: #e6d2b5; /* Pergament */
        }

        body {
            font-family: 'Segoe UI', Tahoma, 'Courier New', sans-serif;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow: hidden;
            user-select: none;
            
            /* Dungeon Background CSS Generator (Smadret) */
            background-color: var(--bg-dark);
            background-image: 
                linear-gradient(to top, rgba(20, 50, 20, 0.4), transparent 30%),
                radial-gradient(circle at 50% 50%, transparent 50%, #000 100%),
                linear-gradient(45deg, var(--stone-dark) 10%, transparent 10%, transparent 40%, var(--stone-dark) 40%, var(--stone-dark) 60%, transparent 60%),
                linear-gradient(-45deg, var(--stone-light) 10%, transparent 10%, transparent 40%, var(--stone-light) 40%, var(--stone-light) 60%, transparent 60%);
            background-size: 100% 100%, 100% 100%, 70px 70px, 70px 70px;
            background-position: 0 0, 0 0, 0px 0px, 35px 35px;
        }

        /* NY: Sp√∏gelses-effekt */
        #ghost-shadow {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            pointer-events: none;
            overflow: hidden;
        }

        .ghost {
            position: absolute;
            top: 20%; 
            left: -100px; 
            width: 300px;
            height: 150px;
            background: rgba(0, 0, 0, 0.2);
            filter: blur(50px);
            opacity: 0.1;
            border-radius: 50%;
            animation: float-by 35s infinite linear;
        }

        @keyframes float-by {
            0% { transform: translate(-100px, 0); opacity: 0.1; }
            5% { opacity: 0.3; }
            95% { opacity: 0.1; }
            100% { transform: translate(100vw, 50px); opacity: 0; }
        }
        
        /* --- UI Containers --- */
        #game-container {
            max-width: 900px;
            width: 100%;
            display: none;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 10;
        }

        #start-screen, #win-screen {
            max-width: 500px;
            background: rgba(20, 20, 25, 0.95);
            padding: 40px;
            border-radius: 4px;
            box-shadow: 0 0 40px rgba(0,0,0,0.8);
            border: 2px solid #555;
            text-align: center;
            position: relative;
            z-index: 100;
            margin-top: 50px;
        }

        #win-screen { display: none; }

        /* --- Stats Bar --- */
        .stats-bar {
            display: flex;
            justify-content: space-around;
            width: 100%;
            background: rgba(0,0,0,0.6);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #444;
            margin-bottom: 20px;
            backdrop-filter: blur(5px);
        }

        .stat-box { text-align: center; }
        .stat-value { font-size: 1.8em; font-weight: bold; text-shadow: 2px 2px 0 #000; }
        .stat-label { font-size: 0.75em; color: #aaa; text-transform: uppercase; letter-spacing: 1px; }

        /* --- Room Area (Cards) --- */
        .room-area {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 20px;
            min-height: 180px;
            padding: 10px;
        }

        /* --- CARD DESIGN --- */
        .card {
            width: var(--card-width);
            height: var(--card-height);
            background-color: var(--card-bg);
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.15'/%3E%3C/svg%3E");
            border-radius: 6px;
            position: relative;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s, opacity 0.3s ease-out;
            box-shadow: 
                inset 0 0 20px rgba(60, 40, 10, 0.4),
                2px 2px 6px rgba(0,0,0,0.6);
            border: 1px solid rgba(0,0,0,0.2);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 8px;
            box-sizing: border-box;
            color: #222;
        }

        .card:hover:not(.disabled) {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 10px 20px rgba(0,0,0,0.7);
            z-index: 10;
        }

        .card.disabled {
            opacity: 0.5;
            filter: grayscale(80%);
            cursor: not-allowed;
            transform: none !important;
        }

        .card.selected-target {
            border: 3px solid var(--danger-color);
            box-shadow: 0 0 15px var(--danger-color);
            transform: scale(1.05);
            animation: none;
        }

        .card-corner { font-size: 1.1em; font-weight: bold; line-height: 1; }
        .card-corner.bottom { transform: rotate(180deg); text-align: left; }
        
        /* RETTET: Ikonst√∏rrelse tilbage til original/stor */
        .card-center-icon { 
            font-size: 3.5em; 
            align-self: center; 
            opacity: 0.9; 
            text-shadow: 0 2px 0 rgba(0,0,0,0.1); 
        }

        /* RETTET: Sikrer at hjerter og ruder har farve */
        .suit-hearts { color: #8a0000; }
        .suit-diamonds { color: #b36b00; }
        .suit-spades, .suit-clubs { color: #1a1a1a; }
        
        /* --- Action Switch --- */
        #action-bar {
            height: 70px;
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            justify-content: center;
            align-items: center;
            width: 100%;
        }

        .combat-switch-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: var(--text-color);
            padding: 10px;
            background: rgba(0,0,0,0.5);
            border-radius: 8px;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 150px;
            height: 40px;
            background-color: #333;
            border-radius: 20px;
            transition: background-color 0.4s;
            cursor: pointer;
            overflow: hidden;
            border: 2px solid #555;
            margin-top: 5px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: transparent;
            transition: 0.4s;
            border-radius: 20px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 30px;
            width: 70px;
            left: 5px;
            bottom: 5px;
            background-color: var(--accent-color);
            transition: 0.4s;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #000;
        }

        /* Text overlay for switch */
        .switch-text {
            position: absolute;
            top: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            font-weight: bold;
            color: #fff;
            pointer-events: none;
            text-shadow: 1px 1px 0 #000;
        }
        .switch-text .left { margin-left: 10px; color: var(--accent-color); }
        .switch-text .right { margin-right: 10px; margin-left: auto; color: var(--danger-color); }


        input:checked + .slider:before {
            transform: translateX(70px);
            background-color: var(--danger-color);
        }
        
        input:disabled + .slider {
            background-color: #555;
            cursor: not-allowed;
        }
        input:disabled + .slider:before {
            background-color: #888;
            left: 5px;
            transform: none;
        }

        /* --- Generelle Knapper --- */
        .btn-std {
            padding: 12px 30px;
            font-size: 1.1em;
            background: #d4af37;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 4px 0 #8b6508;
            transition: all 0.1s;
        }
        .btn-std:hover { background: #e5c14d; }
        .btn-std:active { transform: translateY(2px); box-shadow: 0 1px 0 #8b6508; }

        .btn-flee {
            background: #444; color: #ccc;
            padding: 10px 20px;
            border-radius: 4px; border: 1px solid #666;
            cursor: pointer;
            font-weight: bold;
        }
        .btn-flee:hover:not(:disabled) { background: #555; color: #fff; }
        .btn-flee:disabled { opacity: 0.4; cursor: not-allowed; }

        /* --- Log --- */
        #log {
            width: 100%;
            height: 120px;
            overflow-y: auto;
            background: rgba(0,0,0,0.5);
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.9em;
            border: 1px solid #333;
            color: #ccc;
        }
        .log-line { margin-bottom: 4px; border-bottom: 1px solid #333; padding-bottom: 2px; }
    </style>
</head>
<body>

    <div id="ghost-shadow">
        <div class="ghost" style="animation-delay: 10s;"></div>
        <div class="ghost" style="top: 60%; animation-duration: 25s; animation-delay: 0s;"></div>
    </div>

    <canvas id="confetti-canvas" style="position:fixed; top:0; left:0; pointer-events:none; z-index:999;"></canvas>

    <div id="start-screen">
        <h1>Scoundrel</h1>
        <p style="color:#aaa;">Dungeon crawler med 44 kort.</p> 
        <div style="text-align:left; background:rgba(0,0,0,0.5); padding:15px; border-radius:5px; margin:20px 0; font-size:0.9em;">
            <strong style="color:var(--accent-color)">Regler:</strong><br>
            ‚Ä¢ 4 kort i rummet. Spil 3. Sidste kort f√∏lger med.<br>
            ‚Ä¢ <strong>‚ô• Drikke:</strong> Healer dig. Max 1 pr. rum.<br>
            ‚Ä¢ <strong>‚ô¶ V√•ben:</strong> Udstyr v√•ben. Mister styrke ved brug.<br>
            ‚Ä¢ <strong>‚ô†/‚ô£ Monstre:</strong> Klik for at angribe med valgt metode.
        </div>
        <button class="btn-std" id="btn-start">G√• ind i m√∏rket</button>
    </div>

    <div id="win-screen">
        <h1 style="color:var(--heal-color)">SEJR!</h1>
        <p>Du overlevede fangek√¶lderen.</p>
        <p id="final-score" style="font-size:1.5em; margin:20px 0;"></p>
        <button class="btn-std" onclick="location.reload()">Spil Igen</button>
    </div>

    <div id="game-container">
        
        <div class="stats-bar">
            <div class="stat-box">
                <span class="stat-label">Helbred</span>
                <span class="stat-value" id="hp-display" style="color:var(--heal-color)">20</span>
            </div>
            <div class="stat-box">
                <span class="stat-label">V√•ben</span>
                <span class="stat-value" id="weapon-display">Ingen</span>
            </div>
            <div class="stat-box">
                <span class="stat-label">Rum</span>
                <span class="stat-value" id="room-count">0</span>
            </div>
            <div class="stat-box">
                <span class="stat-label">Bunken</span>
                <span class="stat-value" id="deck-count">0</span>
            </div>
        </div>

        <div id="message-area" style="margin-bottom:10px; min-height:24px; font-weight:bold; color:#fff; text-align:center;">
            V√¶lg et kort...
        </div>

        <div class="room-area" id="room-area"></div>

        <div id="action-bar">
            <div class="combat-switch-container">
                <label for="combat-switch-input" id="switch-label">Kamp Metode</label>
                <label class="switch">
                    <input type="checkbox" id="combat-switch-input" disabled>
                    <span class="slider"></span>
                    <div class="switch-text">
                        <span class="left">‚öîÔ∏è V√•ben</span>
                        <span class="right">üëä N√¶ver</span>
                    </div>
                </label>
            </div>
        </div>

        <div style="margin-bottom:15px;">
            <button id="flee-btn" class="btn-flee">üèÉ Flygt fra rum</button>
        </div>

        <div id="log"></div>

    </div>

<script>
    // --- Config & State ---
    const SUITS = { SPADES: '‚ô†', CLUBS: '‚ô£', HEARTS: '‚ô•', DIAMONDS: '‚ô¶' };
    const TYPE = { MONSTER: 'monster', POTION: 'potion', WEAPON: 'weapon' };
    const ANIMATION_DURATION = 300; 

    let deck = [];
    let roomCards = [];
    let hp = 20;
    let weapon = null;
    let canFlee = true;
    let cardsPlayedInRoom = 0;
    let potionUsedInRoom = false;
    let roomCount = 0; 
    let selectedMonsterIndex = -1; 
    let combatMode = 'weapon'; 

    // --- DOM Elements ---
    const combatSwitchInput = document.getElementById('combat-switch-input');

    // --- Init ---
    document.addEventListener('DOMContentLoaded', () => {
        document.getElementById('btn-start').addEventListener('click', startGame);
        document.getElementById('flee-btn').addEventListener('click', fleeRoom);
        combatSwitchInput.addEventListener('change', updateCombatMode);
    });

    function updateCombatMode() {
        if (!combatSwitchInput.disabled) {
            combatMode = combatSwitchInput.checked ? 'fist' : 'weapon';
            msg(`Angrebsmetode skiftet til: ${combatMode === 'weapon' ? 'V√•ben' : 'N√¶ver'}.`);
        }
    }

    function createDeck() {
        let d = [];
        // Tal kort (2-10) i 4 kul√∏rer (36 kort)
        for(let v=2; v<=10; v++) {
            d.push({s:SUITS.SPADES, v:v, t:TYPE.MONSTER});
            d.push({s:SUITS.CLUBS, v:v, t:TYPE.MONSTER});
            d.push({s:SUITS.HEARTS, v:v, t:TYPE.POTION});
            d.push({s:SUITS.DIAMONDS, v:v, t:TYPE.WEAPON});
        }
        // Billedkort/Es (J, Q, K, A) i 2 kul√∏rer (8 kort)
        [{n:'J',v:11},{n:'Q',v:12},{n:'K',v:13},{n:'A',v:14}].forEach(f => {
            d.push({s:SUITS.SPADES, v:f.v, d:f.n, t:TYPE.MONSTER});
            d.push({s:SUITS.CLUBS, v:f.v, d:f.n, t:TYPE.MONSTER});
        });
        
        // Blander kortene
        for(let i=d.length-1; i>0; i--) {
            const j = Math.floor(Math.random()*(i+1));
            [d[i], d[j]] = [d[j], d[i]];
        }
        return d;
    }

    function startGame() {
        document.getElementById('start-screen').style.display = 'none';
        document.getElementById('game-container').style.display = 'flex';
        deck = createDeck();
        hp = 20;
        weapon = null;
        canFlee = true;
        cardsPlayedInRoom = 0;
        potionUsedInRoom = false;
        roomCount = 0; 
        combatMode = 'weapon'; 
        dealRoom(true);
        updateUI();
        log("Spillet er startet.");
    }

    function isCardPlayable(card) {
        if (!card) return false;
        if (card.t === TYPE.POTION && potionUsedInRoom) {
            return false;
        }
        return true;
    }

    function checkWinCondition() {
        if (deck.length > 0) return false;

        const playableCards = roomCards.filter(isCardPlayable);
        
        if (playableCards.length === 0) {
            winGame();
            return true;
        }
        return false;
    }

    function dealRoom(isNewRoom = true) {
        if (checkWinCondition()) return;

        if(isNewRoom) {
            roomCount++;
        }
        
        roomCards = roomCards.filter(c => c !== null);
        
        while(roomCards.length < 4 && deck.length > 0) {
            roomCards.push(deck.pop());
        }
        cardsPlayedInRoom = 0;
        potionUsedInRoom = false;
        
        selectedMonsterIndex = -1;
        combatMode = 'weapon'; 
        
        if (checkWinCondition()) return; 
    }

    // --- Interaction ---
    function cardClicked(index) {
        const card = roomCards[index];
        if(!card) return;

        if(!isCardPlayable(card)) {
            msg("Du kan ikke bruge det kort nu!");
            return;
        }
        
        // S√¶t selectedMonsterIndex uanset korttype (bruges til visuel feedback, hvis det er et monster)
        selectedMonsterIndex = index; 

        if(card.t === TYPE.MONSTER) {
            const useWeapon = (combatMode === 'weapon' && weapon);
            
            resolveCombat(useWeapon);
            
            // Regel: Hvis man valgte n√¶ver (combatMode === 'fist'), men havde et v√•ben, skift mode tilbage til 'weapon'
            if (combatMode === 'fist' && weapon) {
                combatMode = 'weapon'; 
            }
        }
        else if(card.t === TYPE.WEAPON) {
            weapon = { value: card.v };
            log(`Udstyrede v√•ben ${card.v}.`);
            finishCard(index);
        }
        else if(card.t === TYPE.POTION) {
            let heal = card.v;
            let old = hp;
            hp = Math.min(20, hp + heal);
            potionUsedInRoom = true;
            log(`Healede ${hp-old} HP.`);
            finishCard(index);
        }
        
        selectedMonsterIndex = -1; // Nulstil target
    }

    // --- Combat Logic ---
    function resolveCombat(useWeapon) {
        if(selectedMonsterIndex === -1) return;
        
        const card = roomCards[selectedMonsterIndex];
        let dmg = 0;
        
        if(useWeapon && weapon) {
            if(weapon.value >= card.v) {
                dmg = 0;
                log(`Dr√¶bte monster (${card.v}) fejlfrit med V√•ben.`);
            } else {
                dmg = card.v - weapon.value;
                log(`V√•ben for svagt. Tog ${dmg} skade.`);
            }
            weapon.value = Math.min(weapon.value, card.v);
        } else {
            dmg = card.v;
            log(`Sloges med N√¶verne. Tog ${dmg} skade.`);
        }
        
        hp -= dmg;
        if(hp <= 0) {
            hp = 0;
            updateUI();
            gameOver();
            return;
        }

        finishCard(selectedMonsterIndex);
    }

    // --- Card Removal Flow ---
    function finishCard(index) {
        const cardEl = document.getElementById(`card-${index}`);
        if(cardEl) {
            cardEl.onclick = null; 
            cardEl.style.opacity = '0';
        }

        setTimeout(() => { finishCardLogic(index); }, ANIMATION_DURATION);
    }
    
    function finishCardLogic(index) {
        roomCards[index] = null; 
        cardsPlayedInRoom++;
        
        checkStuck();

        if(checkWinCondition()) return;

        if(cardsPlayedInRoom >= 3) {
            canFlee = true;
            setTimeout(() => {
                dealRoom(true); 
                updateUI();
            }, 300);
        }
        updateUI(); 
    }

    function checkStuck() {
        let activeCards = roomCards.map((c,i)=>({c,i})).filter(x=>x.c!==null);
        let onlyPotions = activeCards.every(x => x.c.t === TYPE.POTION);
        
        if(potionUsedInRoom && onlyPotions && cardsPlayedInRoom < 3) {
            let needed = 3 - cardsPlayedInRoom;
            activeCards.sort((a,b) => a.c.v - b.c.v);
            
            for(let i=0; i<needed; i++) {
                if(i < activeCards.length) {
                    const idxToRemove = activeCards[i].i;
                    log(`Smed potion ${activeCards[i].c.v} v√¶k (regel).`);
                    
                    const cardEl = document.getElementById(`card-${idxToRemove}`);
                    if(cardEl) {
                        cardEl.onclick = null;
                        cardEl.style.opacity = '0';
                    }
                    roomCards[idxToRemove] = null; 
                    cardsPlayedInRoom++;
                }
            }
        }
    }

    function fleeRoom() {
        if(!canFlee || cardsPlayedInRoom > 0) {
            msg("Du kan ikke flygte nu.");
            return;
        }
        let leftover = roomCards.filter(c => c!==null);
        deck.unshift(...leftover);
        roomCards = [];
        canFlee = false;
        log("Flygtede fra rummet!");
        
        dealRoom(false);
        updateUI();
    }

    // --- UI Render ---
    function updateUI() {
        document.getElementById('hp-display').innerText = hp;
        document.getElementById('deck-count').innerText = deck.length;
        document.getElementById('room-count').innerText = roomCount;
        
        let wElem = document.getElementById('weapon-display');
        if(weapon) {
            wElem.innerHTML = `${getIcon(TYPE.WEAPON, weapon.value)} ${weapon.value}`;
            wElem.style.color = "var(--accent-color)";
            
            combatSwitchInput.disabled = false;
            // Opdater visuel switch baseret p√• den logiske combatMode
            combatSwitchInput.checked = (combatMode === 'fist'); 
            document.getElementById('switch-label').style.color = 'white';

        } else {
            wElem.innerText = "Ingen";
            wElem.style.color = "#aaa";
            
            combatSwitchInput.disabled = true;
            combatSwitchInput.checked = false; 
            combatMode = 'fist'; 
            document.getElementById('switch-label').style.color = '#777';
        }
        
        msg(weapon ? 
            `Angriber nu med ${combatMode === 'weapon' ? 'V√•ben' : 'N√¶ver'}...` :
            `Angriber kun med N√¶ver (ingen v√•ben)...`
        );


        document.getElementById('flee-btn').disabled = (!canFlee || cardsPlayedInRoom > 0);

        renderCards();
    }

    function renderCards() {
        const container = document.getElementById('room-area');
        container.innerHTML = "";
        
        roomCards.forEach((c, i) => {
            if(!c) return;
            
            let el = document.createElement('div');
            let disabled = !isCardPlayable(c); 
            
            // Fjernet den fejlbeh√¶ftede logik, der markerede alle monstre ved 'fist' mode uden v√•ben.
            // Kun det kort, man lige har klikket p√•, skal have den r√∏de ramme (via selectedMonsterIndex, som nulstilles hurtigt).
            let isTarget = (selectedMonsterIndex === i); 
            
            el.className = `card ${disabled?'disabled':''} ${isTarget?'selected-target':''}`;
            el.id = `card-${i}`; 
            el.onclick = () => { if(!disabled) cardClicked(i); };
            
            let icon = getIcon(c.t, c.v);
            let valStr = c.d || c.v;
            
            let suitClass = '';
            if(c.s === SUITS.HEARTS) suitClass = 'suit-hearts';
            else if(c.s === SUITS.DIAMONDS) suitClass = 'suit-diamonds';
            else suitClass = 'suit-spades';

            el.innerHTML = `
                <div class="card-corner ${suitClass}">${valStr} ${c.s}</div>
                <div class="card-center-icon">${icon}</div>
                <div class="card-corner bottom ${suitClass}">${valStr} ${c.s}</div>
            `;
            
            let rot = (i * 7 + 3) % 4 - 2;
            el.style.transform = isTarget ? "scale(1.05)" : `rotate(${rot}deg)`;
            
            container.appendChild(el);
        });
    }

    function getIcon(type, v) {
        if(type===TYPE.POTION) return 'üß™';
        if(type===TYPE.WEAPON) {
            if(v<=5) return 'üó°Ô∏è';
            if(v<=8) return '‚öîÔ∏è';
            return 'ü™ì';
        }
        if(type===TYPE.MONSTER) {
            if(v<=5) return 'üêÄ';
            if(v<=8) return 'üßü';
            if(v<=10) return 'üê∫';
            if(v===11) return 'üßõ';
            if(v===12) return 'ü¶Ç';
            if(v===13) return 'üëπ';
            return 'üêâ';
        }
        return '';
    }

    function msg(txt) {
        document.getElementById('message-area').innerText = txt;
    }

    function log(txt) {
        let l = document.getElementById('log');
        let d = document.createElement('div');
        d.className = 'log-line';
        d.innerText = "> " + txt;
        l.prepend(d);
    }

    function winGame() {
        document.getElementById('game-container').style.display = 'none';
        document.getElementById('win-screen').style.display = 'block';
        document.getElementById('final-score').innerText = `Liv tilbage: ${hp} efter ${roomCount} rum.`;
        confetti();
    }
    
    function gameOver() {
        document.getElementById('room-area').innerHTML = 
            "<h2 style='color:red; width:100%; text-align:center;'>DU ER D√òD</h2>";
        setTimeout(() => {
             if(confirm("Du d√∏de! Pr√∏v igen?")) location.reload();
        }, 500);
    }

    // Simple Confetti
    function confetti() {
        const c = document.getElementById('confetti-canvas');
        const x = c.getContext('2d');
        c.width = window.innerWidth; c.height = window.innerHeight;
        let p = [];
        for(let i=0;i<100;i++) p.push({x:Math.random()*c.width, y:Math.random()*c.height-c.height, c:['#f00','#0f0','#00f','#ff0'][Math.floor(Math.random()*4)], s:Math.random()*5+5});
        function loop() {
            x.clearRect(0,0,c.width,c.height);
            p.forEach(o=>{o.y+=3; if(o.y>c.height)o.y=0; x.fillStyle=o.c; x.fillRect(o.x,o.y,o.s,o.s);});
            requestAnimationFrame(loop);
        }
        loop();
    }

</script>
</body>
</html>
